<!DOCTYPE html>
<html  lang="en">
<head>
    <meta charset="utf-8" />

<meta name="generator" content="Hexo 4.2.1" />

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

<title>v2ray configure TLS encryption - comebey</title>


    <meta name="description" content="Finalshell SSH connection tool downloadMobaxterm SSH connection tool download 1. Server time synchronizationSet the hardware clock to be consistent with the local clock, set the time zone to Shanghai">
<meta property="og:type" content="article">
<meta property="og:title" content="v2ray configure TLS encryption">
<meta property="og:url" content="https://www.rootfw.com/posts/3e3bccee.html">
<meta property="og:site_name" content="comebey">
<meta property="og:description" content="Finalshell SSH connection tool downloadMobaxterm SSH connection tool download 1. Server time synchronizationSet the hardware clock to be consistent with the local clock, set the time zone to Shanghai">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ComeBey/imghosting/comebey-pic/M_05.svg">
<meta property="article:published_time" content="2020-07-28T06:54:23.000Z">
<meta property="article:modified_time" content="2020-09-20T12:32:52.765Z">
<meta property="article:author" content="comebey">
<meta property="article:tag" content="v2ray">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/ComeBey/imghosting/comebey-pic/M_05.svg">







<link rel="icon" href="https://cdn.jsdelivr.net/gh/removeif/removeif.github.io@latest/img/wico.png">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/github-gist.css">


    
    
<style>body>.footer,body>.navbar,body>.section{opacity:0}</style>

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">

    
    
    
    
<link rel="stylesheet" href="/en/css/back-to-top.css">

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-174250713-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-174250713-1');
</script>

    
    
    
    <script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:1986829,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>
    
    <link rel="stylesheet" href="/en/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
    
    <script async="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    


<link rel="stylesheet" href="/en/css/style.css">
<link rel="alternate" href="/en/atom.xml" title="comebey" type="application/atom+xml">
</head>
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/en/">
            
                <img src="https://cdn.jsdelivr.net/gh/ComeBey/imghosting/comebey-pic/whale.png" alt="v2ray configure TLS encryption" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item"
                href="/en/">Home</a>
                
                <a class="navbar-item"
                href="/en/archives">Archives</a>
                
                <a class="navbar-item"
                href="/en/categories">Categories</a>
                
                <a class="navbar-item"
                href="/en/tags">Tags</a>
                
                <a class="navbar-item"
                href="https://rootfw.com">中文</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    <a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ComeBey">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                
                
                <a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;">
                    <i class="fas fa-list-ul"></i>
                </a>
                
                
                <a class="navbar-item search" title="Search" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-9-widescreen has-order-2 column-main">
<div class="card">
    
    <div class="card-image">
        <span  class="image is-7by1">
            <img class="thumbnail" src="https://cdn.jsdelivr.net/gh/ComeBey/imghosting/comebey-pic/M_05.svg" alt="v2ray configure TLS encryption">
        </span>
    </div>
    
    <div class="card-content article ">
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <i class="fas fa-angle-double-right"></i>v2ray configure TLS encryption
            
        </h1>
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2020-07-28T06:54:23.000Z"><i class="far fa-calendar-alt">&nbsp;</i>2020-07-28</time>
                
                <time class="level-item has-text-grey is-hidden-mobile" datetime="2020-09-20T12:32:52.765Z"><i class="far fa-calendar-check">&nbsp;</i>2020-09-20</time>
                
                
                <div class="level-item">
                <i class="far fa-folder-open has-text-grey"></i>&nbsp;
                <a class="has-link-grey -link" href="/en/categories/vpn/">vpn</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/en/categories/vpn/v2ray/">v2ray</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    <i class="far fa-clock"></i>&nbsp;
                    
                    
                    9 minutes read (About 1377 words)
                </span>
                
                
                <span class="level-item has-text-grey" id="busuanzi_container_page_pv">
                    <i class="far fa-eye"></i>
                    <span id="busuanzi_value_page_pv">0</span> visits
                </span>
                
            </div>
        </div>
        
        <div class="content">
            <p><a href="https://www.hostbuf.com/t/988.html">Finalshell SSH connection tool download</a><br><a href="https://mobaxterm.mobatek.net/download-home-edition.html">Mobaxterm SSH connection tool download</a></p>
<h3 id="1-Server-time-synchronization"><a href="#1-Server-time-synchronization" class="headerlink" title="1. Server time synchronization"></a>1. Server time synchronization</h3><p>Set the hardware clock to be consistent with the local clock, set the time zone to Shanghai date -R is to view the current time of the server<br>centos7 time synchronization</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">date -R</span><br><span class="line">timedatectl <span class="built_in">set</span>-local-rtc 1</span><br><span class="line">timedatectl <span class="built_in">set</span>-timezone Asia/Shanghai</span><br></pre></td></tr></table></figure>
<a id="more"></a>


<p>Debian system synchronization time is as follows:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">date -R</span><br><span class="line">rm -rf /etc/localtime</span><br><span class="line">cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span><br></pre></td></tr></table></figure>
<h4 id="debian"><a href="#debian" class="headerlink" title="debian"></a>debian</h4><p>Installation dependencies</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt update</span><br><span class="line">apt install curl</span><br></pre></td></tr></table></figure>
<h4 id="centos7"><a href="#centos7" class="headerlink" title="centos7"></a>centos7</h4><p>Installation dependencies</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum makecache</span><br><span class="line">yum install curl</span><br></pre></td></tr></table></figure>
<h3 id="2-Install-dat-and-release-sh"><a href="#2-Install-dat-and-release-sh" class="headerlink" title="2. Install dat and release.sh"></a>2. Install dat and release.sh</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -O https://raw.githubusercontent.com/v2fly/fhs-install-v2ray/master/install-release.sh</span><br><span class="line">curl -O https://raw.githubusercontent.com/v2fly/fhs-install-v2ray/master/install-dat-release.sh</span><br></pre></td></tr></table></figure>
<h3 id="3-Install-and-update-V2Ray"><a href="#3-Install-and-update-V2Ray" class="headerlink" title="3. Install and update V2Ray"></a>3. Install and update V2Ray</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash install-release.sh</span><br></pre></td></tr></table></figure>

<h4 id="Install-v2ray-and-enter-the-following"><a href="#Install-v2ray-and-enter-the-following" class="headerlink" title="Install v2ray and enter the following"></a>Install v2ray and enter the following</h4><p><code>The latest maintenance version of v2fly pulls the latest data and outputs the following content &quot;+&quot; represents the current output content, &quot;-&quot; represents the information deleted on the basis of the old version</code></p>
<figure class="highlight diff"><figcaption><span>each line of code "+", "-" is ignored</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="addition">+info: unzip is installed.</span></span><br><span class="line"><span class="addition">+info: Extract the V2Ray package to /tmp/tmp.RS0y2YR2ZS/ and prepare it for installation.</span></span><br><span class="line"><span class="addition">+installed: /usr/local/bin/v2ray</span></span><br><span class="line"><span class="addition">+installed: /usr/local/bin/v2ctl</span></span><br><span class="line"><span class="addition">+installed: /usr/local/lib/v2ray/geoip.dat</span></span><br><span class="line"><span class="addition">+installed: /usr/local/lib/v2ray/geosite.dat</span></span><br><span class="line"><span class="addition">+installed: /usr/local/etc/v2ray/config.json</span></span><br><span class="line"><span class="deletion">-installed: /usr/local/etc/v2ray/00_log.json</span></span><br><span class="line"><span class="deletion">-installed: /usr/local/etc/v2ray/01_api.json</span></span><br><span class="line"><span class="deletion">-installed: /usr/local/etc/v2ray/02_dns.json</span></span><br><span class="line"><span class="deletion">-installed: /usr/local/etc/v2ray/03_routing.json</span></span><br><span class="line"><span class="deletion">-installed: /usr/local/etc/v2ray/04_policy.json</span></span><br><span class="line"><span class="deletion">-installed: /usr/local/etc/v2ray/05_inbounds.json</span></span><br><span class="line"><span class="deletion">-installed: /usr/local/etc/v2ray/06_outbounds.json</span></span><br><span class="line"><span class="deletion">-installed: /usr/local/etc/v2ray/07_transport.json</span></span><br><span class="line"><span class="deletion">-installed: /usr/local/etc/v2ray/08_stats.json</span></span><br><span class="line"><span class="deletion">-installed: /usr/local/etc/v2ray/09_reverse.json</span></span><br><span class="line"><span class="deletion">-installed: /var/log/v2ray/</span></span><br><span class="line"><span class="addition">+installed: /var/log/v2ray/access.log</span></span><br><span class="line"><span class="addition">+installed: /var/log/v2ray/error.log</span></span><br><span class="line"><span class="addition">+installed: /etc/systemd/system/v2ray.service</span></span><br><span class="line"><span class="addition">+installed: /etc/systemd/system/v2ray@.service</span></span><br><span class="line"><span class="addition">+removed: /tmp/tmp.KojGXm19Pa/</span></span><br><span class="line"><span class="addition">+info: V2Ray v4.27.0 is installed.</span></span><br></pre></td></tr></table></figure>
<h3 id="4-Install-the-latest-geoip-dat-and-geosite-dat"><a href="#4-Install-the-latest-geoip-dat-and-geosite-dat" class="headerlink" title="4. Install the latest geoip.dat and geosite.dat"></a>4. Install the latest geoip.dat and geosite.dat</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash install-dat-release.sh</span><br></pre></td></tr></table></figure>
<h3 id="5-Create-and-edit-configuration-files"><a href="#5-Create-and-edit-configuration-files" class="headerlink" title="5. Create and edit configuration files"></a>5. Create and edit configuration files</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;usr&#x2F;local&#x2F;etc&#x2F;v2ray</span><br></pre></td></tr></table></figure>
<p>Create a new config.json configuration file under /usr/local/etc/v2ray<br>Copy the following code to config.json</p>
<figure class="highlight json"><figcaption><span>/usr/local/etc/v2ray</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"inbounds"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"port"</span>: <span class="number">443</span>, <span class="comment">// port 443 is recommended</span></span><br><span class="line">      <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</span><br><span class="line">      <span class="attr">"settings"</span>: &#123;</span><br><span class="line">        <span class="attr">"clients"</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">"id"</span>: <span class="string">"23ad6b10-8d1ae3e35cd38297"</span>, <span class="comment">//UUID</span></span><br><span class="line">            <span class="attr">"alterId"</span>: <span class="number">64</span> <span class="comment">//extra id</span></span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">"streamSettings"</span>: &#123;</span><br><span class="line">        <span class="attr">"network"</span>: <span class="string">"tcp"</span>, <span class="comment">//The protocol replaces itself such as WS</span></span><br><span class="line">        <span class="attr">"security"</span>: <span class="string">"tls"</span>, <span class="comment">// security must be set to tls to enable TLS</span></span><br><span class="line">        <span class="attr">"tlsSettings"</span>: &#123;</span><br><span class="line">          <span class="attr">"certificates"</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="attr">"certificateFile"</span>: <span class="string">"/etc/v2ray/v2ray.crt"</span>, <span class="comment">// certificate file</span></span><br><span class="line">              <span class="attr">"keyFile"</span>: <span class="string">"/etc/v2ray/v2ray.key"</span> <span class="comment">// key file</span></span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">"outbounds"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"protocol"</span>: <span class="string">"freedom"</span>,</span><br><span class="line">      <span class="attr">"settings"</span>: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>v2ray debugging</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl restart v2ray</span><br><span class="line">sudo systemctl status -l v2ray</span><br></pre></td></tr></table></figure>
<p>Set v2ray to boot up</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable v2ray</span><br></pre></td></tr></table></figure>

<h3 id="6-Generate-a-certificate"><a href="#6-Generate-a-certificate" class="headerlink" title="6. Generate a certificate"></a>6. Generate a certificate</h3><p>*<em>If you already have other certificates, you can ignore them. Put the certificate and key in the specified directory of the server. There are too many ways to apply for a certificate. You can generate a certificate by installing the acme.sh tool or other methods to generate a certificate. You can search on Google. *</em></p>
<p><strong>1. Install the acem.sh certificate generation tool. The following provides 3 methods to install, choose any one of them to install the certificate tool (Reminder: automatically upgrade acme.sh and enter acme.sh upgrade under root)</strong></p>
<figure class="highlight bash"><figcaption><span>/root/.acme.sh</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">curl https://get.acme.sh | sh // If the installation fails, please install curl first and enter yum -y install curl</span><br><span class="line"></span><br><span class="line">wget -O-https://get.acme.sh | sh //If it prompts that the installation fails, please (install wget first) enter yum -y install wget already installed ignore</span><br><span class="line"></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/acmesh-official/acme.sh.git // If the installation fails, install git first. Ignore those already installed. Enter yum install git</span><br><span class="line"><span class="built_in">cd</span> ./acme.sh</span><br><span class="line">./acme.sh --install</span><br></pre></td></tr></table></figure>
<p>Install acme.sh through the above code and prompt <code>red</code> to hold wrong. You can install dependencies according to the actual situation, such as installing socat or netcat<br>       <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">centos7 yum install socat <span class="comment">#Dependency of generating certificate through port 80</span></span><br><span class="line">centos7 yum isntall netcat</span><br><span class="line"></span><br><span class="line">debian apt-get install openssl cron socat curl</span><br><span class="line">debian apt-get -y install netcat</span><br><span class="line"></span><br><span class="line">After the installation is successful, execute <span class="built_in">source</span> ~/.bashrc <span class="comment"># to ensure that the command alias set by the script takes effect</span></span><br></pre></td></tr></table></figure></p>
<p><strong>2. Generate the certificate path under the /root/.acme.sh file, you can check it yourself after installation</strong><br>  <strong>Reminder: There are many ways to generate a certificate through acme.sh:</strong><br>  For example — automatic DNS API integration such as: cloudflare DNS API token and use of global API key acme.sh supports most dns to generate certificates<br>  For example — use DNS manual mode, and many other installation methods, if you are a good learner, you can Google</p>
<p>  The generated certificate is as follows: This video only uses the specified port to generate the certificate <strong>It is recommended to use the 443 port to generate the certificate</strong> (Generally, a single domain name is sufficient, after all, it is used to overcome the wall and do not need to do so many bells and whistles, such as the main domain baidu. com is not recommended to use <a href="http://www.baidu.com">www.baidu.com</a> because it is the front-end web over the wall, please customize such as tw.baidu.com, the prefix tw can be customized, please do not write too long, the main domain baidu.com and secondary <a href="http://www.baidu">www.baidu</a>. com can spare you understand)</p>
<p><strong>1. Apply for a certificate by listening on port 80, if port 80 is occupied, please use port 443, please make sure these ports are open</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ~&#x2F;.acme.sh&#x2F;acme.sh --issue -d domain name --standalone -k ec-256</span><br></pre></td></tr></table></figure>
<p><strong>2. If you use a non-standard port 80 behind the reverse proxy or load balancer, you can use –httpport to specify the port</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ~&#x2F;.acme.sh&#x2F;acme.sh --issue -d domain name --standalone --httpport port</span><br></pre></td></tr></table></figure>
<p><strong>3. Listen on port 443 to issue certificates, please make sure port 443 is open</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ~&#x2F;.acme.sh&#x2F;acme.sh --issue -d domain name --alpn -k ec-256</span><br></pre></td></tr></table></figure>

<p><strong>4. If you use non-standard port 443 behind the reverse proxy or load balancer, you can use –tlsport to specify the port</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ~&#x2F;.acme.sh&#x2F;acme.sh --issue -d domain name --alpn --tlsport port</span><br></pre></td></tr></table></figure>
<p>  <strong>-k means the length of the key, the following values ​​can be ec-256, ec-384, 2048, 3072, 4096, 8192, with ec means that the generated ECC certificate is, and if it is not, it is the RSA certificate. In terms of security, a 256-bit ECC certificate is equivalent to a 3072-bit RSA certificate</strong></p>
<p>Reminder: If port 80 or 443 is occupied and we cannot apply for the key and certificate, we can block the port through kill and apply again.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">netstat -tlnp|grep 80</span><br><span class="line">or</span><br><span class="line">netstat -tlnp|grep 443</span><br><span class="line">then</span><br><span class="line">kill 1103 (this 1103 is the process port id)</span><br><span class="line"></span><br><span class="line">If it cannot be terminated, it can be terminated forcibly</span><br><span class="line">kill -9 1103</span><br></pre></td></tr></table></figure>

<h3 id="7-Install-the-certificate-and-key-to-the-specified-path"><a href="#7-Install-the-certificate-and-key-to-the-specified-path" class="headerlink" title="7. Install the certificate and key to the specified path"></a>7. Install the certificate and key to the specified path</h3><p>/etc/v2ray (path can be customized)</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ecc installation code sudo ~/.acme.sh/acme.sh --installcert -d domain name --fullchainpath /etc/v2ray/v2ray.crt --keypath /etc/v2ray/v2ray.key --ecc</span><br><span class="line"></span><br><span class="line">rsa installation code sudo ~/.acme.sh/acme.sh --installcert -d domain name --fullchainpath /etc/v2ray/v2ray.crt --keypath /etc/v2ray/v2ray.key</span><br></pre></td></tr></table></figure>
<p>Modify /etc/v2ray/v2ray.key to 644 permissions</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod 644 &#x2F;etc&#x2F;v2ray&#x2F;v2ray.key</span><br></pre></td></tr></table></figure>

<h3 id="8-BBr-installation"><a href="#8-BBr-installation" class="headerlink" title="8. BBr installation"></a>8. BBr installation</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget <span class="string">"https://github.com/chiakge/Linux-NetSpeed/raw/master/tcp.sh"</span> &amp;&amp; chmod +x tcp.sh &amp;&amp; ./tcp.sh</span><br></pre></td></tr></table></figure>
<h3 id="9-Query-tls-on-status"><a href="#9-Query-tls-on-status" class="headerlink" title="9. Query tls on status"></a>9. Query tls on status</h3><p><a href="https://www.ssllabs.com/ssltest/index.html">https://www.ssllabs.com/ssltest/index.html</a> Enter your own domain name to query<br>About config.json configuration file can be written by yourself, of course, it also includes various other load balancing, reverse proxy. If you want to improve yourself in a short time, you can participate in my training class.</p>
<h3 id="10-If-you-want-to-uninstall-V2Ray-execute-the-following-code"><a href="#10-If-you-want-to-uninstall-V2Ray-execute-the-following-code" class="headerlink" title="10. If you want to uninstall V2Ray, execute the following code"></a>10. If you want to uninstall V2Ray, execute the following code</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash install-release.sh --remove</span><br></pre></td></tr></table></figure>

<p><a href="https://t.me/RootInstitute">chat telegram group</a></p>

        </div>
        
            <ul class="post-copyright">
            <li><strong>title：</strong><a href="https://www.rootfw.com/posts/3e3bccee.html">v2ray configure TLS encryption</a></li>
            <li><strong>Author：</strong><a href="https://www.rootfw.com">comebey</a></li>
            <li><strong>URL：</strong><a href="https://www.rootfw.com/posts/3e3bccee.html">https://www.rootfw.com/posts/3e3bccee.html</a></li>
            <li><strong>Posted on：</strong>2020-07-28</li>
            <li><strong>Licensed unde：</strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明出处！
            </li>
            </ul>
        
        
        <hr style="height:1px;margin:1rem 0"/>
        <div class="level is-size-7 is-uppercase">
            <div class="level-start">
                <div class="level-item">
                    <i class="fas fa-tags has-text-grey"></i>&nbsp;
                    <a class="has-link-grey -link" href="/en/tags/v2ray/" rel="tag">v2ray</a>
                </div>
            </div>
        </div>
        
        
        
        
<div class="sharethis-inline-share-buttons"></div>
<script type='text/javascript' src='https://platform-api.sharethis.com/js/sharethis.js#property=5f5759bfd449570011d2b344&amp;product=sop' async='async'></script>

        
    </div>
</div>



<div class="card">
    <div class="card-content">
        <h3 class="menu-label has-text-centered">Like this article? Support the author with</h3>
        <div class="buttons is-centered">
            
                
<a class="button is-info donate">
    <span class="icon is-small">
        <i class="fab fa-alipay"></i>
    </span>
    <span>Alipay</span>
    <div class="qrcode"><img src="https://cdn.jsdelivr.net/gh/ComeBey/imghosting/comebey-pic/alipay.png" alt="Alipay"></div>
</a>

                
                
<a class="button is-success donate">
    <span class="icon is-small">
        <i class="fab fa-weixin"></i>
    </span>
    <span>Wechat</span>
    <div class="qrcode"><img src="https://cdn.jsdelivr.net/gh/ComeBey/imghosting/comebey-pic/wechat.png" alt="Wechat"></div>
</a>

                
        </div>
    </div>
</div>



<div class="card card-transparent">
    <div class="level post-navigation is-flex-wrap is-mobile">
        
        <div class="level-start">
            <a class="level level-item has-link-grey  article-nav-prev" href="/en/posts/d2834d54.html">
                <i class="level-item fas fa-chevron-left"></i>
                <span class="level-item">V2ray+WS+TLS+Nginx</span>
            </a>
        </div>
        
        
        <div class="level-end">
            <a class="level level-item has-link-grey  article-nav-next" href="/en/posts/f3e24172.html">
                <span class="level-item">v2ray官方新老脚本安装</span>
                <i class="level-item fas fa-chevron-right"></i>
            </a>
        </div>
        
    </div>
</div>



<div class="card">
    <div class="card-content">
        <h3 class="title is-5 has-text-weight-normal">Comments</h3>
        
<script>
    var disqus_config = function () {
        this.page.url = 'https://www.rootfw.com/posts/3e3bccee.html';
        this.page.identifier = 'posts/3e3bccee.html';
    };
    (function() {
        var d = document, s = d.createElement('script');  
        s.src = '//' + 'hasan-blog' + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>

<div id="disqus_thread">
    
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
    </div>
</div>
</div>
                
    
    
    
    
    <div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
        
            
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered" style="flex-shrink: 1">
                <div>
                    
                    <figure class="image is-200x200 has-mb-6">
                        <img class="" src="/en/images/avatar.png" alt="ComeBey">
                    </figure>
                    
                    <p class="is-size-4 is-block">
                        ComeBey
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        Hasan
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>Shanghai, China</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Posts
                    </p>
                    <a href="/en/archives">
                        <p class="title has-text-weight-normal">
                            20
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Categories
                    </p>
                    <a href="/en/categories">
                        <p class="title has-text-weight-normal">
                            21
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Tags
                    </p>
                    <a href="/en/tags">
                        <p class="title has-text-weight-normal">
                            17
                        </p>
                    </a>
                </div>
            </div>
        </nav>
        
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://www.youtube.com/channel/UC1BAUCyjE7NLpvcwSUInOIg/?sub_confirmation=1" target="_blank" rel="noopener">
                Follow</a>
        </div>
        
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="Github" href="https://github.com/ComeBey">
                
                <i class="fab fa-github"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="Facebook" href="https://www.facebook.com/Comebey.Blog/?modal=admin_todo_tour">
                
                <i class="fab fa-facebook"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="Twitter" href="https://twitter.com/WangTao_Im">
                
                <i class="fab fa-twitter"></i>
                
            </a>
            
        </div>
        
    </div>
</div>
        
            

    <div class="card widget column-left is-sticky" id="toc">
        <div class="card-content">
            <div class="menu">
                <h3 class="menu-label">
                    Catalogue
                </h3>
                <ul class="menu-list"><li>
        <a class="is-flex" href="#1-Server-time-synchronization">
        <span class="has-mr-6">1</span>
        <span>1. Server time synchronization</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#debian">
        <span class="has-mr-6">1.1</span>
        <span>debian</span>
        </a></li><li>
        <a class="is-flex" href="#centos7">
        <span class="has-mr-6">1.2</span>
        <span>centos7</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#2-Install-dat-and-release-sh">
        <span class="has-mr-6">2</span>
        <span>2. Install dat and release.sh</span>
        </a></li><li>
        <a class="is-flex" href="#3-Install-and-update-V2Ray">
        <span class="has-mr-6">3</span>
        <span>3. Install and update V2Ray</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#Install-v2ray-and-enter-the-following">
        <span class="has-mr-6">3.1</span>
        <span>Install v2ray and enter the following</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#4-Install-the-latest-geoip-dat-and-geosite-dat">
        <span class="has-mr-6">4</span>
        <span>4. Install the latest geoip.dat and geosite.dat</span>
        </a></li><li>
        <a class="is-flex" href="#5-Create-and-edit-configuration-files">
        <span class="has-mr-6">5</span>
        <span>5. Create and edit configuration files</span>
        </a></li><li>
        <a class="is-flex" href="#6-Generate-a-certificate">
        <span class="has-mr-6">6</span>
        <span>6. Generate a certificate</span>
        </a></li><li>
        <a class="is-flex" href="#7-Install-the-certificate-and-key-to-the-specified-path">
        <span class="has-mr-6">7</span>
        <span>7. Install the certificate and key to the specified path</span>
        </a></li><li>
        <a class="is-flex" href="#8-BBr-installation">
        <span class="has-mr-6">8</span>
        <span>8. BBr installation</span>
        </a></li><li>
        <a class="is-flex" href="#9-Query-tls-on-status">
        <span class="has-mr-6">9</span>
        <span>9. Query tls on status</span>
        </a></li><li>
        <a class="is-flex" href="#10-If-you-want-to-uninstall-V2Ray-execute-the-following-code">
        <span class="has-mr-6">10</span>
        <span>10. If you want to uninstall V2Ray, execute the following code</span>
        </a></li></ul>
            </div>
        </div>
    </div>

        
        
            <div class="column-right-shadow is-hidden-widescreen ">
            
            </div>
        
    </div>
    
                
            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/en/">
                
                    <img src="https://cdn.jsdelivr.net/gh/ComeBey/imghosting/comebey-pic/whale.png" alt="v2ray configure TLS encryption" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2020 comebey&nbsp;
                Powered by <a href="https://www.youtube.com/channel/UC1BAUCyjE7NLpvcwSUInOIg/?sub_confirmation=1" target="_blank" rel="noopener">comebey</a> & <a
                        href="https://github.com/ComeBey" target="_blank" rel="noopener">Hasan</a>
                
                <br>
                <span id="busuanzi_container_site_uv">
                Visited by <span id="busuanzi_value_site_uv">0</span> users
                </span>
                
                </p>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                        
                        <i class="fab fa-creative-commons"></i>&nbsp;<i class="fab fa-creative-commons-by"></i>&nbsp;<i class="fab fa-creative-commons-nc"></i>&nbsp;<i class="fab fa-creative-commons-sa"></i>&nbsp;
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="AlphaLxy GitHub" href="https://www.github.com/ComeBey">
                        
                        <i class="fab fa-github"></i>&nbsp;
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("en");</script>


<script>
var IcarusThemeSettings = {
    site: {
        url: 'https://www.rootfw.com',
        external_link: {"enable":true,"exclude":[]}
    },
    article: {
        highlight: {
            clipboard: true,
            fold: 'unfolded'
        }
    }
};
</script>


<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>





<script src="/en/js/animation.js"></script>



<script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
<script src="/en/js/gallery.js" defer></script>



<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>


<a id="back-to-top" title="Back to Top" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/en/js/back-to-top.js" defer></script>














<script src="/en/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/en/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/en/js/insight.js" defer></script>
<link rel="stylesheet" href="/en/css/search.css">
<link rel="stylesheet" href="/en/css/insight.css">
    
</body>
</html>